(function(f){var c={init:function(m){var n={preset:null,maxItems:10,url:null,type:"atom",title:null,headingIcon:{src:a},alsoIcon:{src:a},feature:null,includeFeatureDate:false,alsoTitle:{text:"Also in the news"},viewAll:{text:"View All"},includeHeadlineDate:false,includeTodaysDate:false,openLinksInNewWindow:false,addClass:["emory-feed"]};if(m.preset!=null){if(!e.hasOwnProperty(m.preset)){f.error("Preset "+m.preset+" does not exist.")}else{f.extend(true,n,e[m.preset],m)}}else{if(m){f.extend(true,n,m)}}return this.each(function(){var o=f(this);b(n.url,function(p){if(p.entries.length<1){return}if((typeof(n.addClass)=="string")){n.addClass=[n.addClass]}if((typeof(n.addClass)=="object")){for(i in n.addClass){o.addClass(n.addClass[i])}}o.html(j);k(o,n,p);if(n.feature!=null){h(o,n,p)}else{f(".feed-feature",o).remove()}if(p.entries.length>1){d(o,n,p)}else{f(".feed-body",o).remove()}o.trigger("load.emoryfeed")},n.maxItems)})}};var a="https://www.emory.edu/home/img/rss.gif";var j="<div class='feed-heading'></div><div class='feed-feature'></div><div class='feed-body'></div>";var g=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];var e=[];e["1 - Emory Homepage"]={maxItems:7,feature:{useContentSnippet:false,contentSelector:"p:first",maxWords:30,readMoreText:"Continue Reading",thumbnail:{selector:"img"}},alsoIcon:null,title:{text:"Emory News"},alsoTitle:{text:"Also In The News"},viewAll:{text:"View all news"},addClass:["emory-feed","home-news"]};e["2 - Emory Right Rail"]={maxItems:4,feature:{useContentSnippet:true,contentSelector:"p:first",maxWords:0,thumbnail:{selector:"img",prepend:true}},headingIcon:null,alsoIcon:null,alsoTitle:null,viewAll:{text:"More News"},includeTodaysDate:true,addClass:["emory-feed","right-rail"]};e["3 - Interior Narrow News - Feature Above"]={maxItems:5,feature:{useContentSnippet:false,contentSelector:"p:first",maxWords:50,readMoreText:"Continue reading"},title:{text:"Featured News"},alsoTitle:{text:"More News"},headingIcon:null,alsoIcon:{src:a},viewAll:{text:"More Research News"},addClass:["emory-feed","interior-narrow-feature-above"]};e["4 - Simple Headlines Only"]={maxItems:8,headingIcon:null,alsoIcon:null,alsoTitle:null,viewAll:null,addClass:["emory-feed","simple-headlines"]};e["5 - WHSC Wide News - Feature - Latest Headlines"]={maxItems:16,feature:{heading:{text:"Featured Story"},useContentSnippet:false,contentSelector:"p:first",maxWords:50,readMoreText:"More",thumbnail:{selector:"img"}},headingIcon:null,includeHeadlineDate:true,alsoTitle:{text:"Latest Headlines"},viewAll:[{text:"View all 2011 Releases"},{text:"View all Emory News"}],addClass:["emory-feed","interior-wide"]};e["6 - Interior Narrow News - No Feature"]={maxItems:5,alsoTitle:null,title:{text:"Latest news"},alsoIcon:null,includeHeadlineDate:true,headingIcon:{src:a},viewAll:{text:"View all news"},addClass:["emory-feed","interior-narrow-no-feature"]};var k=function(p,q,o){var m=q.title;var s={text:o.title,linkURL:o.link};f.extend(true,s,m);var r=f("<a></a>");r.attr("href",s.linkURL);if(q.openLinksInNewWindow){r.attr("target","_blank")}r.append(s.text);if(s.linkURL!=null){r=f("<h2>"+r.outerHTML()+"</h2>")}else{r=f("<h2>"+r.html()+"</h2>")}r.addClass("feed-title");f(".feed-heading",p).append(r);var t=q.headingIcon;if(t!=null&&t.src!=null){if(t.linkURL==null){t.linkURL=o.feedUrl}$icon=f("<a></a>").addClass("feed-icon");$icon.attr("href",t.linkURL);if(q.openLinksInNewWindow){$icon.attr("target","_blank")}$iconImg=f("<img></img>");$iconImg.attr("src",t.src);$iconImg.attr("alt",q.type);$icon.append($iconImg);f(".feed-heading",p).append($icon)}if(q.includeTodaysDate){$todaysDate=f("<p></p>").addClass("todays-date");var n=new Date();$todaysDate.append(g[n.getMonth()]+". "+n.getDate());f(".feed-heading",p).append($todaysDate)}};var h=function(n,z,y){var t=z.feature;var A={useContentSnippet:false,maxWords:250,includeDate:false};f.extend(true,A,t);var C=y.entries[0];var o=A.heading;if(o!=null){var v=f("<h3></h3>").addClass("feed-feature-heading");v.append(o.text);f(".feed-feature",n).append(v)}$headline=f("<a></a>");if(z.openLinksInNewWindow){$headline.attr("target","_blank")}$headline.append(C.title);$headline.attr("href",C.link);$headline=f("<h3>"+$headline.outerHTML()+"</h3>");$headline.addClass("feed-feature-headline");f(".feed-feature",n).append($headline);if(A.thumbnail!=null&&A.thumbnail.selector!=null&&f(A.thumbnail.selector,C.content).size()>0){var D=f(A.thumbnail.selector,C.content);var p=f("<img></img>").attr("src",D.attr("src"));p.addClass("feed-feature-thumbnail");p=f("<a>"+p.outerHTML()+"</a>").attr("href",C.link);if(z.openLinksInNewWindow){p.attr("target","_blank")}if(f("img",p).attr("src").length>0&&A.thumbnail.prepend!=null&&A.thumbnail.prepend==true){f(".feed-feature",n).prepend(p)}else{f(".feed-feature",n).append(p)}if(A.thumbnail.maxWidth!=null||A.thumbnail.maxHeight){p.find("img").css("visibility","hidden");f(window).load(function(){var I=p.width();var H=p.height();var F=parseInt(A.thumbnail.maxWidth);var E=parseInt(A.thumbnail.maxHeight);var G=I/H;if(I>F){I=F;H=parseInt(Math.floor(F/G))}if(H>E){H=E;I=parseInt(Math.floor(G*E))}p.find("img").css({width:I,height:H,visibility:"visible"})})}}$content=f("<div></div>").addClass("feed-feature-content");if(z.includeFeatureDate==true){var m=f("<p></p>").addClass("feed-feature-date");var B=new Date(C.publishedDate);B=g[B.getMonth()]+" "+B.getDate();m.append(B);f(".feed-feature",n).append(m)}if(parseInt(z.feature.maxWords)>0){var x=f("<div></div>").addClass("feed-feature-summary");var q="";if(A.useContentSnippet){q=C.contentSnippet}else{if(z.feature.contentSelector!=null){q=f(z.feature.contentSelector,f("<div>"+C.content+"</div>")).text()}else{q=f("<div>"+C.content+"</div>").text()}}var s=q.split(" ");var u="";if(z.feature.maxWords!=null){for(var w=0;w<z.feature.maxWords&&w<s.length;w++){u=u+" "+s[w]}if(u.charAt(u.length-1)!="."){u=u+"..."}}else{u=q}x.append(u)}if(m!=null){$content.append(m)}if(x!=null){$content.append(x)}if(r!=null){$content.append(r)}f(".feed-feature",n).append($content);if(z.feature.readMoreText!=null){var r=f("<a></a>");r.attr("href",C.link);if(z.openLinksInNewWindow){r.attr("target","_blank")}r.append(z.feature.readMoreText);r=f("<p>"+r.outerHTML()+"</p>").addClass("feed-feature-more");f(".feed-feature",n).append(r)}};var d=function(p,B,A){var t=B.alsoTitle;var n=B.alsoIcon;var z;if(t!=null||n!=null){z=f("<div></div>").addClass("feed-also-heading")}if(t!=null&&t.text!=null){var q=f("<h3></h3>").addClass("also-title");var C=t.text;if(t.linkURL!=null){C=f("<a>"+t.text+"</a>").attr("href",t.linkURL);if(B.openLinksInNewWindow){C.attr("target","_blank")}}q.append(C);z.append(q)}if(n!=null&&n.src!=null){if(n.linkURL==null){n.linkURL=A.feedUrl}$icon=f("<a></a>").addClass("feed-icon");$icon.attr("href",n.linkURL);if(B.openLinksInNewWindow){$icon.attr("target","_blank")}$iconImg=f("<img></img>");$iconImg.attr("src",n.src);$iconImg.attr("alt",B.type);$icon.append($iconImg);z.append($icon)}f(".feed-body",p).append(z);for(var v=((B.feature!=null)?1:0);v<A.entries.length&&v<B.maxItems;v++){var o=A.entries[v];var x=f("<div></div>").addClass("headline-block");if(B.includeHeadlineDate){var m=f("<span></span>").addClass("headline-date");var D=new Date(o.publishedDate);D=g[D.getMonth()]+" "+D.getDate();m.append(D);x.append(m)}var s=f("<a></a>").attr("href",o.link);if(B.openLinksInNewWindow){s.attr("target","_blank")}s.append(o.title);s=f("<span>"+s.outerHTML()+"</span>").addClass("headline-title");x.append(s);f(".feed-body",p).append(x)}if(B.viewAll!=null){if(!(B.viewAll.constructor==Array)){var y=[B.viewAll]}else{y=B.viewAll}for(var v=0;v<y.length;v++){var r=y[v];if(r.text!=null){var u=f("<a></a>");if(B.openLinksInNewWindow){u.attr("target","_blank")}u.append(r.text);var w;if(r.linkURL!=null){w=r.linkURL}else{w=A.link}u.attr("href",w);u=f("<p>"+u.outerHTML()+"</p>").addClass("view-all");f(".feed-body",p).append(u)}}}};var l="https://ajax.googleapis.com/ajax/services/feed/load?v=1.0&callback=?&q=";var b=function(n,p,m,o){var q=l+n;if(m!=null){q+="&num="+m}if(o!=null){q+="&key="+o}q+="&refreshInterval=60";f.getJSON(q,function(u){if(typeof p=="function"){var t=u.responseData;var s=u.responseDetails;var r=((parseInt(u.responseStatus)>=300)?true:false);if(r){f.error("Encountered error code "+u.responseStatus+" : "+s)}else{p.call(this,u.responseData.feed)}}else{return false}})};f.fn.emoryFeed=function(m){if(c[m]){return c[m].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof m==="object"||!m){return c.init.apply(this,arguments)}else{f.error("Method "+m+" does not exist in jQuery.emoryFeed.")}}};f.fn.outerHTML=function(m){return m?this.before(m).remove():jQuery("<p>").append(this.eq(0).clone()).html()}})(jQuery);